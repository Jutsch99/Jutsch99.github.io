<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Try 2 Yen-Gar 2D ‚Äì Free Placement Board</title>
<style>
  :root{
    --bg:#0f1115;
    --panel:#151823;
    --accent:#3da9fc;
    --text:#e6e8ee;
    --muted:#8c93a3;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Arial,sans-serif}
  .wrap{min-height:100%;display:flex;flex-direction:column;gap:16px;padding:14px}

  /* Board area */
  .board-wrap{
    margin:0 auto;
    max-width:1100px;
    width:100%;
    position:relative;
    user-select:none;
    touch-action:none; /* allow custom dragging on touch */
  }
  #boardImg{
    width:100%;
    height:auto;
    display:block;
    border-radius:10px;
    box-shadow:0 10px 30px rgba(0,0,0,.5);
    background:#07224a;
  }
  /* Where pieces live on top of the board */
  #pieceLayer{
    position:absolute; inset:0;
    /* Make layer interactive so placed pieces can be picked up anytime */
    pointer-events:auto;
  }
  .piece{
    position:absolute;
    width:var(--pieceSize, 10%); /* slightly bigger default */
    transform:translate(-50%,-50%);
    pointer-events:auto; /* interactive while placed */
    touch-action:none;
    will-change:transform, left, top;
    user-select:none;
  }
  .piece, .symbol img{ -webkit-user-drag: none; }

  /* Hub */
  .hud{
    margin:0 auto;
    max-width:1100px;
    width:100%;
    background:linear-gradient(180deg,#161a26,#10131c);
    border:1px solid #232738;
    border-radius:12px;
    box-shadow:0 8px 28px rgba(0,0,0,.45);
    padding:14px 12px 18px;
  }
  .topbar{
    display:flex; align-items:center; justify-content:center; gap:14px; margin-bottom:10px;
  }
  .btn{
    background:#1f2434;border:1px solid #2b3248;color:var(--text);
    padding:.6rem 1rem;border-radius:10px;font-weight:600;cursor:pointer;
    transition:transform .05s ease, background .2s ease, border-color .2s ease;
  }
  .btn:active{ transform:translateY(1px) }
  .diceOut{
    min-width:56px;text-align:center;font-size:1.25rem;font-weight:800;
    padding:.55rem .9rem;border-radius:10px;border:1px dashed #2b3248;color:var(--accent);
    background:#141827;
  }

  .symbols{
    display:flex; flex-wrap:wrap; align-items:center; justify-content:center; gap:14px;
  }
  .symbol{
    display:grid; place-items:center;
    width:min(9.5vw,90px);
    aspect-ratio:1/1;
    padding:6px;
    border-radius:12px;
    background:#121623;
    border:1px solid #262c40;
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.02);
    cursor:grab;
    position:relative;
  }
  .symbol:active{ cursor:grabbing }
  .symbol img{
    max-width:95%; max-height:95%;
    object-fit:contain;
    display:block;
    filter:drop-shadow(0 3px 6px rgba(0,0,0,.35));
  }

  /* Trash bin */
  .trash{
    display:flex; gap:10px; align-items:center; justify-content:center;
    margin-top:14px;
    border:1px dashed #2b3248; border-radius:12px; padding:10px;
    color:var(--muted); background:#0f1422;
  }
  .trash .icon{ font-size:24px; line-height:1 }
  .trash.active{ border-color:#d14; color:#ffb0b0; background:#1a0f15 }
  .hint{font-size:.85rem;color:var(--muted);text-align:center;margin-top:8px}
</style>
</head>
<body>
  <div class="wrap">
    <!-- BOARD (Horizontal, responsive, hi‚Äëres) -->
    <div class="board-wrap" id="boardWrap">
      <img id="boardImg" src="board.png" alt="Game Board" draggable="false">
      <div id="pieceLayer" aria-label="Placed pieces layer"></div>
    </div>

    <!-- HUB -->
    <section class="hud" aria-label="Hub">
      <div class="topbar">
        <button id="rollBtn" class="btn" type="button">üé≤ Roll Dice</button>
        <div class="diceOut" id="diceOut">‚Äî</div>
        <button id="resetBtn" class="btn" type="button" title="Remove all pieces">‚Ü∫ Reset Board</button>
      </div>

      <!-- Unlimited spawners: each is a symbol; dragging creates a clone -->
      <div class="symbols" id="symbols">
        <!-- Reference sprites exactly as named -->
        <div class="symbol" data-src="red.png" title="Red">
          <img src="red.png" alt="red" draggable="false">
        </div>
        <div class="symbol" data-src="Top disc.png" title="Top disc">
          <img src="Top disc.png" alt="Top disc" draggable="false">
        </div>
        <div class="symbol" data-src="king.png" title="King">
          <img src="king.png" alt="king" draggable="false">
        </div>
        <div class="symbol" data-src="yellow.png" title="Yellow">
          <img src="yellow.png" alt="yellow" draggable="false">
        </div>
        <div class="symbol" data-src="spawner.png" title="Spawner">
          <img src="spawner.png" alt="spawner" draggable="false">
        </div>
        <div class="symbol" data-src="green.png" title="Green">
          <img src="green.png" alt="green" draggable="false">
        </div>
        <div class="symbol" data-src="wall black.png" title="Wall black">
          <img src="wall black.png" alt="wall black" draggable="false">
        </div>
        <div class="symbol" data-src="purple.png" title="Purple">
          <img src="purple.png" alt="purple" draggable="false">
        </div>
        <div class="symbol" data-src="blue.png" title="Blue">
          <img src="blue.png" alt="blue" draggable="false">
        </div>
        <div class="symbol" data-src="special.png" title="Special">
          <img src="special.png" alt="special" draggable="false">
        </div>
        <div class="symbol" data-src="wall white.png" title="Wall white">
          <img src="wall white.png" alt="wall white" draggable="false">
        </div>
      </div>

      <div class="trash" id="trash">
        <span class="icon">üóëÔ∏è</span>
        <span>Drag a piece here to delete it</span>
      </div>

      <p class="hint">Tip: Tap/press any symbol to spawn a piece, then drag it onto the board. Symbols stay ‚Äì pieces are unlimited.</p>
    </section>
  </div>

<script>
(function(){
  const boardWrap = document.getElementById('boardWrap');
  const boardImg  = document.getElementById('boardImg');
  const layer     = document.getElementById('pieceLayer');
  const symbols   = document.getElementById('symbols');
  const trash     = document.getElementById('trash');
  const rollBtn   = document.getElementById('rollBtn');
  const diceOut   = document.getElementById('diceOut');
  const resetBtn  = document.getElementById('resetBtn');

  // ---- Responsive piece size based on board width (slightly larger than before)
  function setPieceSize(){
    const p = Math.max(7, Math.min(14, Math.round(boardImg.clientWidth / 90))); // bigger
    layer.style.setProperty('--pieceSize', p + '%');
  }
  new ResizeObserver(setPieceSize).observe(boardImg);

  // ---- Dice
  rollBtn.addEventListener('click', ()=>{
    const t = Date.now()+350;
    const interval = setInterval(()=>{
      diceOut.textContent = 1 + Math.floor(Math.random()*6);
      if(Date.now()>t){ clearInterval(interval); }
    }, 50);
  });

  // ---- Reset board: remove all placed pieces
  resetBtn.addEventListener('click', ()=>{
    [...layer.querySelectorAll('.piece')].forEach(p=>p.remove());
  });

  // ---- Drag logic (Pointer Events = works for touch + mouse)
  let dragging = null;

  // Convert page coords to percent-of-board placement
  function posToBoardPercent(clientX, clientY){
    const r = boardWrap.getBoundingClientRect();
    const x = (clientX - r.left) / r.width;
    const y = (clientY - r.top)  / r.height;
    return { x, y, inside: x>=0 && x<=1 && y>=0 && y<=1 };
  }

  function startDragFromSymbol(ev, src){
    ev.preventDefault();
    const img = new Image();
    img.src = src;
    img.className = 'piece';
    img.alt = 'piece';
    img.draggable = false;
    layer.appendChild(img);
    dragging = img;
    moveDrag(ev);
  }

  function moveDrag(ev){
    if(!dragging) return;
    const pt = ev.touches ? ev.touches[0] : ev;
    const {x,y} = posToBoardPercent(pt.clientX, pt.clientY);
    // Clamp slightly outside board so you can park on edges
    const cx = Math.max(-0.02, Math.min(1.02, x));
    const cy = Math.max(-0.02, Math.min(1.02, y));
    dragging.style.left = (cx*100)+'%';
    dragging.style.top  = (cy*100)+'%';

    // Trash hover feedback
    const tr = trash.getBoundingClientRect();
    const overTrash = pt.clientX>=tr.left && pt.clientX<=tr.right && pt.clientY>=tr.top && pt.clientY<=tr.bottom;
    trash.classList.toggle('active', overTrash);
  }

  function endDrag(ev){
    if(!dragging) return;
    const pt = ev.changedTouches ? ev.changedTouches[0] : ev;
    const tr = trash.getBoundingClientRect();
    const overTrash = pt.clientX>=tr.left && pt.clientX<=tr.right && pt.clientY>=tr.top && pt.clientY<=tr.bottom;
    if(overTrash){
      dragging.remove();
    }
    trash.classList.remove('active');
    dragging = null;
  }

  // Spawn from symbols (unlimited)
  symbols.addEventListener('pointerdown', (e)=>{
    const target = e.target.closest('.symbol');
    if(!target) return;
    startDragFromSymbol(e, target.getAttribute('data-src'));
  }, {passive:false});
  symbols.addEventListener('touchstart', (e)=>{
    const t = e.target.closest('.symbol'); if(!t) return;
    startDragFromSymbol(e, t.getAttribute('data-src'));
  }, {passive:false});

  // Allow dragging of already-placed pieces
  layer.addEventListener('pointerdown', (e)=>{
    const img = e.target.closest('.piece'); if(!img) return;
    dragging = img;
    moveDrag(e);
  }, {passive:false});
  layer.addEventListener('touchstart', (e)=>{
    const img = e.target.closest('.piece'); if(!img) return;
    dragging = img;
    moveDrag(e);
  }, {passive:false});

  // Move / End events on window so you don‚Äôt lose drag
  window.addEventListener('pointermove', moveDrag, {passive:false});
  window.addEventListener('pointerup', endDrag, {passive:true});
  window.addEventListener('touchmove', moveDrag, {passive:false});
  window.addEventListener('touchend', endDrag, {passive:true});
  window.addEventListener('touchcancel', endDrag, {passive:true});

  // Kick once
  window.addEventListener('load', setPieceSize);
})();
</script>
</body>
</html>